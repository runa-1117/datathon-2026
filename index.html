<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Access to a Livable Planet | Datathon 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Top bar -->
  <header class="top">
    <div class="container top__inner">
      <div class="top__title"> 7th DubsTech Datathon </div>
      <nav class="top__nav">
        <a href="#top">Home</a>
        <a href="#viz">Visualization</a>
        <a href="#ml">Machine Learning</a>
      </nav>
    </div>
  </header>

  <!-- Overview -->
  <section class="section section--hero" id="top">
    <div class="container hero-content">
      <div class="hero-badge">DubsTech Datathon 2026</div>
      <h1>Access to a <span class="hero-accent">Livable Planet</span></h1>
      <p class="lead">
        <span class="callout">Who gets clean air, and who bears the burden of pollution?</span>
      </p>
      <p class="hero-desc">
        Using EPA AQI data, we apply machine learning and data visualization to uncover hidden air quality risk patterns across U.S. counties.
      </p>

      <div class="kpi">
        <div class="kpi__card kpi__card--problem">
          <div class="kpi__icon">&#x26A0;</div>
          <div class="kpi__label">Problem</div>
          <div class="kpi__value">Persistent regional disparities in air pollution, with climate threats reversing decades of progress</div>
        </div>
        <div class="kpi__card kpi__card--approach">
          <div class="kpi__icon">&#x2699;</div>
          <div class="kpi__label">Approach</div>
          <div class="kpi__value">Machine learning + Data visualizations</div>
        </div>
        <div class="kpi__card kpi__card--outcome">
          <div class="kpi__icon">&#x1F4CD;</div>
          <div class="kpi__label">Outcome</div>
          <div class="kpi__value">Classified U.S. counties into 4 air quality types and predicted 2026 high-risk areas</div>
        </div>
      </div>

      <div class="scroll-hint">
        <span class="scroll-hint__text">Scroll to explore</span>
        <div class="scroll-hint__arrow">&#8595;</div>
      </div>
    </div>
  </section>

  <!-- Visualization 1 -->
  <section class="section section--tint" id="viz">
    <div class="container">
      <div class="section-header">
        <span class="section-num">1</span>
        <h2>Analytics & Visualization</h2>
      </div>

      <div class="analysis-stack">
        <div class="analysis-item">
          <h3 class="analysis-item__label">Question</h3>
          <p>How does air quality vary by¬†region?</p>
        </div>
      </div>

      <div class="analysis-findings">
        <h3>What we found</h3>
        <ul>
          <li><strong>Regional Inequity Persists</strong><br>
            Western/coastal counties face consistently higher pollution, while the Midwest achieved near-zero by 2010. Within states, local hotspots remain despite national averages improving.</li>
          <li><strong>Urban and Industrial Corridors Bear Disproportionate Burden</strong><br>
            Counties with high traffic density (NO‚ÇÇ) and industrial activity (PM2.5) show overlapping pollution exposure. Metro areas and manufacturing hubs experience multi-pollutant challenges that rural regions largely avoid.</li>
          <li><strong>Federal Policy Delivers, Then Plateaus</strong><br>
            The 1990 Clean Air Act cut unhealthy days by 80%, but post-2015 gains stalled. We've tackled industrial emissions‚Äînow face harder challenges like wildfires and agriculture.</li>
          <li><strong>Climate Threats Reversing Progress</strong><br>
            The West's 2020‚Äì2021 wildfire-driven spike shows traditional pollution controls can't address climate-driven air quality challenges. New policy approaches needed.</li>
        </ul>
      </div>

      <div class="viz">
        <div class='tableauPlaceholder' id='viz1770553096594' style='position: relative'>
          <noscript><a href='#'><img alt=' ' src='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard1/1_rss.png' style='border: none' /></a></noscript>
          <object class='tableauViz' style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
            <param name='embed_code_version' value='3' />
            <param name='site_root' value='' />
            <param name='name' value='Datathon2026_17705177818560/Dashboard1' />
            <param name='tabs' value='yes' />
            <param name='toolbar' value='yes' />
            <param name='static_image' value='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard1/1.png' />
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='en-US' />
          </object>
        </div>
        <script type='text/javascript'>
          var divElement = document.getElementById('viz1770553096594');
          var vizElement = divElement.getElementsByTagName('object')[0];
          if (divElement.offsetWidth > 800) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else if (divElement.offsetWidth > 500) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else {
            vizElement.style.width = '100%';
            vizElement.style.height = '1200px';
          }
          var scriptElement = document.createElement('script');
          scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
          vizElement.parentNode.insertBefore(scriptElement, vizElement);
        </script>
      </div>
    </div>
  </section>

  <!-- Visualization 2 -->
  <section class="section" id="viz2">
    <div class="container">
      <div class="section-header">
        <span class="section-num">2</span>
        <h2>Analytics & Visualization</h2>
      </div>

      <div class="analysis-stack">
        <div class="analysis-item">
          <h3 class="analysis-item__label">Question</h3>
          <p>Visualize trends over time in AQI: identify improving or worsening regions</p>
        </div>
      </div>

      <div class="analysis-findings">
        <h3>What we found</h3>
        <ul>
          <li><strong>Overall Improvement Since Clean Air Act Amendments (1990)</strong><br>
            All U.S. regions show significant declines in unhealthy air quality days since 1990, when the Clean Air Act Amendments were implemented. The national average dropped from over 5% unhealthy days in the early 1980s to under 1% by 2025. This demonstrates the effectiveness of federal environmental regulation.</li>
          <li><strong>Midwest Success Story vs. Persistent Coastal Challenges</strong><br>
            The Midwest achieved near-zero unhealthy days by 2010 and maintained it, while the Northeast and West still hover around 0.5‚Äì1%. This gap likely reflects coastal urbanization, traffic density, and (for the West) wildfires‚Äîfactors requiring targeted interventions.</li>
          <li><strong>Regional Patterns Reveal Persistent Disparities</strong><br>
            Despite nationwide progress, regional differences remain entrenched. Coastal and western regions face unique pollution sources that federal-level policies alone cannot fully address.</li>
          <li><strong>Recent Stagnation Raises Concerns</strong><br>
            Post-2015, all regions converge near 0‚Äì0.5% unhealthy days, but improvement has slowed. The West's recent uptick (likely from wildfires) suggests climate change may reverse gains in some regions. Current policies designed for industrial pollution may not adequately address new threats like wildfire smoke.</li>
        </ul>
      </div>

      <div class="viz">
        <div class='tableauPlaceholder' id='viz1770553088359' style='position: relative'>
          <noscript><a href='#'><img alt=' ' src='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard2/1_rss.png' style='border: none' /></a></noscript>
          <object class='tableauViz' style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
            <param name='embed_code_version' value='3' />
            <param name='site_root' value='' />
            <param name='name' value='Datathon2026_17705177818560/Dashboard2' />
            <param name='tabs' value='yes' />
            <param name='toolbar' value='yes' />
            <param name='static_image' value='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard2/1.png' />
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='en-US' />
          </object>
        </div>
        <script type='text/javascript'>
          var divElement = document.getElementById('viz1770553088359');
          var vizElement = divElement.getElementsByTagName('object')[0];
          if (divElement.offsetWidth > 800) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else if (divElement.offsetWidth > 500) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else {
            vizElement.style.width = '100%';
            vizElement.style.height = '1200px';
          }
          var scriptElement = document.createElement('script');
          scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
          vizElement.parentNode.insertBefore(scriptElement, vizElement);
        </script>
      </div>
    </div>
  </section>

  <!-- Visualization 3 -->
  <section class="section section--tint" id="viz3">
    <div class="container">
      <div class="section-header">
        <span class="section-num">3</span>
        <h2>Analytics & Visualization</h2>
      </div>

      <div class="analysis-stack">
        <div class="analysis-item">
          <h3 class="analysis-item__label">Question</h3>
          <p>Compare exposure to specific pollutants (PM2.5, Ozone, NO‚ÇÇ) across counties</p>
        </div>
      </div>

      <div class="analysis-findings">
        <h3>What we found</h3>
        <ul>
          <li><strong>Ozone is the Most Widespread Threat</strong><br>
            Nationally, ozone exposure days (~150K) far exceed PM2.5 and NO‚ÇÇ, making it the most pervasive air quality challenge. Unlike traffic-related NO‚ÇÇ, ozone affects both urban and rural counties.</li>
          <li><strong>California and the Midwest Face Multi-Pollutant Burdens</strong><br>
            High-exposure counties (red/orange on map) cluster in California/Southwest (wildfires, urban density) and Midwest industrial corridors. These regions face overlapping PM2.5, ozone, and NO‚ÇÇ exposure‚Äîcompounding health risks.</li>
          <li><strong>County-Level Disparities Reveal Structural Inequity</strong><br>
            The color gradient shows extreme variation: some counties experience 100+ exposure days while others have near-zero. High-exposure areas align with industrial zones, traffic corridors, and wildfire-prone regions‚Äîcreating systematic environmental disadvantages.</li>
        </ul>
      </div>

      <div class="viz">
        <div class='tableauPlaceholder' id='viz1770553088359_3' style='position: relative'>
          <noscript><a href='#'><img alt=' ' src='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard2/1_rss.png' style='border: none' /></a></noscript>
          <object class='tableauViz' style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
            <param name='embed_code_version' value='3' />
            <param name='site_root' value='' />
            <param name='name' value='Datathon2026_17705177818560/Dashboard2' />
            <param name='tabs' value='yes' />
            <param name='toolbar' value='yes' />
            <param name='static_image' value='https://public.tableau.com/static/images/Da/Datathon2026_17705177818560/Dashboard2/1.png' />
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='en-US' />
          </object>
        </div>
        <script type='text/javascript'>
          var divElement = document.getElementById('viz1770553088359_3');
          var vizElement = divElement.getElementsByTagName('object')[0];
          if (divElement.offsetWidth > 800) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else if (divElement.offsetWidth > 500) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else {
            vizElement.style.width = '100%';
            vizElement.style.height = '1200px';
          }
          var scriptElement = document.createElement('script');
          scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
          vizElement.parentNode.insertBefore(scriptElement, vizElement);
        </script>
      </div>
    </div>
  </section>

  <!-- Visualization 4 -->
  <section class="section" id="viz4">
    <div class="container">
      <div class="section-header">
        <span class="section-num">4</span>
        <h2>Analytics & Visualization</h2>
      </div>

      <div class="analysis-stack">
        <div class="analysis-item">
          <h3 class="analysis-item__label">Question</h3>
          <p>Identify areas at the intersection of high pollution and vulnerable populations</p>
        </div>
      </div>

      <div class="analysis-findings">
        <h3>What we found</h3>
        <ul>
          <li>
            <strong>PM2.5 Shows Strong Correlation with Vulnerable Populations</strong><br>
            Counties with high breast cancer mortality are disproportionately exposed to elevated PM2.5 levels. Texas leads with 14 counties facing both risks, followed by Indiana (12), Washington (11), and Ohio (11). This pattern is concentrated in industrial corridors and urban centers.
          </li>
          <li>
            <strong>NO‚ÇÇ Impact is Limited and Urban-Focused</strong><br>
            Only 3 states show overlap between NO‚ÇÇ exposure and breast cancer mortality (Texas: 6, Georgia: 1, California: 1). This stark difference reflects NO‚ÇÇ's primary source‚Äîtraffic emissions‚Äîwhich creates a clear urban-rural divide in exposure patterns.
          </li>
          <li>
            <strong>Geographic Inequity Reveals Structural Problems</strong><br>
            The overlap isn't random. High-risk counties cluster in petrochemical regions (Texas Gulf Coast), manufacturing hubs (Midwest), and areas with poor air quality infrastructure. Communities already dealing with cancer are systematically exposed to worse environmental conditions.
          </li>
          <li>
            <strong>PM2.5's Broader Sources Make It a Greater Threat</strong><br>
            Unlike NO‚ÇÇ, PM2.5 comes from multiple sources: industrial emissions, wildfires, and vehicle exhaust. This means it affects both urban and rural populations, making it harder to avoid and creating widespread exposure for vulnerable groups.
          </li>
        </ul>
      </div>

      <!-- Tableau Embed -->
      <div class="viz">
        <div class='tableauPlaceholder' id='viz1770545359112' style='position: relative'>
          <noscript><a href='#'><img alt='Dashboard 1' src='https://public.tableau.com/static/images/5T/5TKPSJRRR/1_rss.png' style='border: none' /></a></noscript>
          <object class='tableauViz' style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
            <param name='embed_code_version' value='3' />
            <param name='path' value='shared/5TKPSJRRR' />
            <param name='toolbar' value='yes' />
            <param name='static_image' value='https://public.tableau.com/static/images/5T/5TKPSJRRR/1.png' />
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='en-US' />
            <param name='filter' value='publish=yes' />
          </object>
        </div>
        <script type='text/javascript'>
          var divElement = document.getElementById('viz1770545359112');
          var vizElement = divElement.getElementsByTagName('object')[0];
          if (divElement.offsetWidth > 800) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else if (divElement.offsetWidth > 500) {
            vizElement.style.width = '100%';
            vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
          } else {
            vizElement.style.width = '100%';
            vizElement.style.height = '1477px';
          }
          var scriptElement = document.createElement('script');
          scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
          vizElement.parentNode.insertBefore(scriptElement, vizElement);
        </script>
      </div>
    </div>
  </section>

  <!-- Machine Learning -->
  <section class="section section--tint" id="ml">
    <div class="container">
      <h2>Machine Learning on County Level Air Quality</h2>

      <p class="muted">To uncover hidden patterns in air quality across U.S. counties and identify future air quality risks, we used <a href="https://github.com/Marc0Guo/Datathon-2026/blob/main/high_risk_cluster.ipynb" target="_blank" rel="noopener noreferrer" style="text-decoration: underline;">K-means</a> and <a href="https://github.com/Marc0Guo/Datathon-2026/blob/main/extreme_event_early_warning.ipynb" target="_blank" rel="noopener noreferrer" style="text-decoration: underline;">XGBoost</a> algorithms to perform cluster analysis on long-term air quality data and predict the most likely air quality conditions in different regions in 2026. We aim to reveal the underlying geographical, climatic, industrial, and natural factors behind these patterns and help policymakers and community leaders identify high-risk areas and prioritize air purification efforts.
      </p>


      <!-- Method + Model Choice -->
      <div class="ml-text-grid">
        <div class="ml-text-card">
          <h4>üí° Key Results</h4>
          <ul class="ml-list">
            <li>Evident based annotation on 4 clusters</li>
            <li>US Map visualization for cluster analysis</li>
            <li>2026 Top10% AQI counties prediction 2026</li>
          </ul>
        </div>

        <div class="ml-text-card">
          <h4> üéÆ Interactive Prediction Tool</h4>
          <ul class="ml-list">
            <li>Enter the state and county you are interested in</li>
            <li>Receive the prediction of 2026 air quality condition</li>
            <li>Plus the profile and interpretation of  cluster</li>
          </ul>
        </div>
      </div>

      <!-- Results -->
      <div class="ml-grid">
        <figure class="ml-figure">
          <h3 class="ml-figure__title">Air Quality Cluster Map</h3>
          <img
            src="assets/air_quality_cluster_map.png"
            alt="Air Quality Cluster Map"
            width="1200"
            height="800"
          />
        </figure>

        <div class="ml-legend">
          <div class="legend-item">
            <span class="dot dot-red"></span>
            <div>
              <div class="legend-title">High Burden Mixed</div>
              <div class="muted">Worst overall air quality and stronger extreme events.</div>
            </div>
          </div>

          <div class="legend-item">
            <span class="dot dot-orange"></span>
            <div>
              <div class="legend-title">PM2.5 Chronic</div>
              <div class="muted">Steady, long-term particulate pollution.</div>
            </div>
          </div>

          <div class="legend-item">
            <span class="dot dot-yellow"></span>
            <div>
              <div class="legend-title">Ozone-Dominant</div>
              <div class="muted">Seasonal ozone-driven pollution.</div>
            </div>
          </div>

          <div class="legend-item">
            <span class="dot dot-green"></span>
            <div>
              <div class="legend-title">Clean but Spiky</div>
              <div class="muted">Mostly clean air with short pollution spikes.</div>
            </div>
          </div>

          <div class="legend-item">
            <span class="dot dot-gray"></span>
            <div>
              <div class="legend-title">Insufficient Monitoring</div>
              <div class="muted">
                Counties without sufficient EPA air quality monitoring coverage.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Finding -->
      <div class="ml-finding">
        <h3>ü§ñ Interactive Lookup</h3>
        <p class="muted">
          Select a county to see its air quality cluster classification and 2026 risk prediction based on long-term pollution patterns.
        </p>

        <div class="cluster-lookup">
          <div class="cluster-lookup__controls">
            <div class="form-group">
              <label for="state-select" class="form-label">State</label>
              <select id="state-select" name="state" class="form-select" aria-label="Select state">
                <option value="">Select a state‚Ä¶</option>
              </select>
            </div>

            <div class="form-group">
              <label for="county-select" class="form-label">County</label>
              <select id="county-select" name="county" class="form-select" aria-label="Select county" disabled>
                <option value="">Select a county‚Ä¶</option>
              </select>
            </div>
          </div>

          <div id="risk-result" class="risk-result" role="status" aria-live="polite" style="display: none;">
            <div class="risk-result__header">
              <h4 class="risk-result__title">üéØ 2026 Risk Prediction (Powered by XGBoost)</h4>
            </div>

            <div class="risk-metrics">
              <div class="risk-metric">
                <div class="risk-metric__label">Probability of Risk Flag</div>
                <div class="risk-metric__value" id="risk-prob">‚Äî</div>
              </div>

              <div class="risk-metric">
                <div class="risk-metric__label">Risk Status</div>
                <div class="risk-metric__badge" id="risk-flag">‚Äî</div>
              </div>
            </div>
          </div>

          <div id="cluster-result" class="cluster-result" role="status" aria-live="polite" style="display: none;">
            <div class="cluster-result__header">
              <span class="cluster-result__dot"></span>
              <h4 class="cluster-result__title"></h4>
            </div>

            <div class="cluster-section">
              <h5 class="cluster-section__title">Profile</h5>
              <ul class="cluster-section__list" id="cluster-profile"></ul>
            </div>

            <div class="cluster-section">
              <h5 class="cluster-section__title">Interpretation</h5>
              <ul class="cluster-section__list" id="cluster-interpretation"></ul>
            </div>

            <div class="cluster-section">
              <h5 class="cluster-section__title">Real-world Implication</h5>
              <ul class="cluster-section__list" id="cluster-implication"></ul>
            </div>
          </div>
        </div>
      </div>

      <script>
        // Cluster labels and descriptions
        const clusterLabels = {
          0: {
            name: "Ozone-Dominant (Powered by K-Means)",
            color: "yellow",
            profile: [
              "High share of ozone-dominated pollution days.",
              "Low contributions from PM2.5, PM10, CO, and NO2.",
              "Low overall pollution intensity, with relatively low median and peak AQI levels.",
              "Slightly higher proportion of good air-quality days."
            ],
            interpretation: [
              "Air quality is generally acceptable, but pollution episodes are driven by ozone rather than particulate matter.",
              "Pollution is mainly driven by photochemical reactions instead of direct emissions."
            ],
            implication: [
              "Common in regions with strong sunlight and warm temperatures.",
              "Health risk is more related to short-term respiratory irritation during high-ozone periods."
            ]
          },
          1: {
            name: "PM2.5 Chronic (Powered by K-Means)",
            color: "orange",
            profile: [
              "<strong>PM2.5</strong> is the dominant pollutant.",
              "Higher share of unhealthy days across the year.",
              "Extreme pollution peaks are limited; pollution levels remain consistently elevated.",
              "Reflects persistent, long-term exposure rather than short-term events."
            ],
            interpretation: [
              "Represents chronic background pollution with limited variability.",
              "Air quality problems are sustained over time rather than driven by rare extremes."
            ],
            implication: [
              "Often linked to winter inversions, residential burning, or long-lasting regional emissions.",
              "Long-term health burden is high, especially for cardiovascular and respiratory outcomes."
            ]
          },
          2: {
            name: "Clean but Spiky (Traffic/Dust) (Powered by K-Means)",
            color: "green",
            profile: [
              "Highest proportion of good air-quality days.",
              "Very low median AQI, but extremely high peak-to-median ratios.",
              "Strong signals in NO2, CO, and PM10.",
              "Pollution is dominated by rare but severe spikes."
            ],
            interpretation: [
              "Air quality is usually clean, but short-lived pollution events occur.",
              "Variability is driven by episodic sources rather than persistent exposure."
            ],
            implication: [
              "Common near highways, urban corridors, or dust-prone regions.",
              "Health risks are mainly associated with acute exposure during short pollution episodes."
            ]
          },
          3: {
            name: "High-Burden Mixed (Powered by K-Means)",
            color: "red",
            profile: [
              "Highest share of unhealthy days.",
              "Elevated median AQI indicates generally poor air quality.",
              "Multiple pollutants contribute simultaneously, including PM2.5, ozone, and NO2.",
              "Combines long-term exposure with moderate extreme events."
            ],
            interpretation: [
              "Represents structurally poor air quality driven by multiple sources.",
              "Pollution is both persistent and periodically intensified."
            ],
            implication: [
              "Often found in dense urban or industrial regions, and wildfire-affected areas.",
              "Poses both chronic health risks and heightened vulnerability to extreme pollution events."
            ]
          }
        };

        // Load and parse cluster data
        let countyData = [];
        let riskData = {};

        // Load risk prediction data
        fetch('pred_2026.json')
          .then(response => response.json())
          .then(data => {
            riskData = data;
            console.log('Risk data loaded:', Object.keys(riskData).length, 'counties');
          })
          .catch(error => {
            console.error('Error loading risk data:', error);
          });

        fetch('cluster.csv')
          .then(response => response.text())
          .then(csv => {
            const lines = csv.trim().split('\n');

            // Skip header and parse all data
            for (let i = 1; i < lines.length; i++) {
              const [, state, county, cluster] = lines[i].split(',');
              if (state && county && cluster !== undefined) {
                countyData.push({
                  state: state.trim(),
                  county: county.trim(),
                  cluster: parseInt(cluster)
                });
              }
            }

            // Populate state dropdown
            const states = [...new Set(countyData.map(d => d.state))].sort();
            const stateSelect = document.getElementById('state-select');
            states.forEach(state => {
              const option = document.createElement('option');
              option.value = state;
              option.textContent = state;
              stateSelect.appendChild(option);
            });
          })
          .catch(error => {
            console.error('Error loading cluster data:', error);
            const resultDiv = document.getElementById('cluster-result');
            resultDiv.innerHTML = '<p style="color: #EF4444; font-weight: 600;">‚ö†Ô∏è Failed to load cluster data. Please run this page through a web server (e.g., <code>python3 -m http.server</code>).</p>';
            resultDiv.style.display = 'block';
          });

        // Handle state selection
        document.getElementById('state-select').addEventListener('change', function(e) {
          const selectedState = e.target.value;
          const countySelect = document.getElementById('county-select');
          const clusterResultDiv = document.getElementById('cluster-result');
          const riskResultDiv = document.getElementById('risk-result');

          // Reset county dropdown and hide results
          countySelect.innerHTML = '<option value="">Select a county‚Ä¶</option>';
          clusterResultDiv.style.display = 'none';
          riskResultDiv.style.display = 'none';

          if (selectedState) {
            // Filter counties by state
            const counties = countyData
              .filter(d => d.state === selectedState)
              .map(d => ({ name: d.county, cluster: d.cluster }))
              .sort((a, b) => a.name.localeCompare(b.name));

            counties.forEach(county => {
              const option = document.createElement('option');
              option.value = county.cluster;
              option.textContent = county.name;
              option.dataset.countyName = county.name;
              option.dataset.stateName = selectedState;
              countySelect.appendChild(option);
            });

            countySelect.disabled = false;
          } else {
            countySelect.disabled = true;
          }
        });

        // Handle county selection
        document.getElementById('county-select').addEventListener('change', function(e) {
          const cluster = parseInt(e.target.value);
          const clusterResultDiv = document.getElementById('cluster-result');
          const riskResultDiv = document.getElementById('risk-result');
          const selectedOption = e.target.options[e.target.selectedIndex];
          const countyName = selectedOption.dataset.countyName;
          const stateName = selectedOption.dataset.stateName;

          if (!isNaN(cluster) && clusterLabels[cluster]) {
            const info = clusterLabels[cluster];

            // Update cluster result display
            const dot = clusterResultDiv.querySelector('.cluster-result__dot');
            const title = clusterResultDiv.querySelector('.cluster-result__title');

            dot.className = `cluster-result__dot dot-${info.color}`;
            title.textContent = info.name;

            // Populate profile
            const profileList = document.getElementById('cluster-profile');
            profileList.innerHTML = '';
            info.profile.forEach(item => {
              const li = document.createElement('li');
              li.innerHTML = item;
              profileList.appendChild(li);
            });

            // Populate interpretation
            const interpretationList = document.getElementById('cluster-interpretation');
            interpretationList.innerHTML = '';
            info.interpretation.forEach(item => {
              const li = document.createElement('li');
              li.innerHTML = item;
              interpretationList.appendChild(li);
            });

            // Populate implication
            const implicationList = document.getElementById('cluster-implication');
            implicationList.innerHTML = '';
            info.implication.forEach(item => {
              const li = document.createElement('li');
              li.innerHTML = item;
              implicationList.appendChild(li);
            });

            clusterResultDiv.style.display = 'block';

            // Display risk prediction data
            if (countyName && stateName) {
              const riskKey = `${stateName.toLowerCase()}__${countyName.toLowerCase().replace(/\s+/g, '')}`;
              const riskInfo = riskData[riskKey];

              if (riskInfo) {
                // Update risk probability
                const riskProb = (riskInfo.risk_prob * 100).toFixed(1);
                document.getElementById('risk-prob').textContent = `${riskProb}%`;

                // Update risk flag
                const riskFlagEl = document.getElementById('risk-flag');
                if (riskInfo.risk_flag_top10 === 1) {
                  riskFlagEl.innerHTML = '<span class="risk-badge risk-badge--high">üö© High Risk (Top 10%)</span>';
                } else {
                  riskFlagEl.innerHTML = '<span class="risk-badge risk-badge--normal">‚úì Normal Risk</span>';
                }

                riskResultDiv.style.display = 'block';
              } else {
                console.warn('No risk data found for:', riskKey);
                riskResultDiv.style.display = 'none';
              }
            }
          } else {
            clusterResultDiv.style.display = 'none';
            riskResultDiv.style.display = 'none';
          }
        });
      </script>
    </div>
  </section>

  <!-- Links -->
  <section class="section section--footer" id="links">
    <div class="container">
      <h2>Project Resources</h2>
      <ul class="links">
        <li><a href="https://drive.google.com/drive/u/0/folders/1e-E_GUNo2w_4CTxRWZUdz8_r0qKi5bW5" target="_blank" rel="noopener noreferrer">üìÅ Google Drive Folder</a></li>
        <li><a href="https://github.com/Marc0Guo/Datathon-2026" target="_blank" rel="noopener noreferrer">üíª GitHub Repository</a></li>
      </ul>

      <footer class="footer">
        <span class="muted">Runa He, Marco Guo, Anna Huang, Amelia Li ‚Ä¢ DubsTech Datathon ‚Ä¢ 2026</span>
      </footer>
    </div>
  </section>
</body>
</html>
